<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>AdvancedDBEngine Worker Demo</title>
</head>
<body>
  <script type="module">
    import { DB } from '../js/db.js';

    (async () => {
      // 1) Create the DB wrapper, pointing to our worker, specifying store names
      const db = new DB("ORDERS_DB",['Users', 'Orders']);

      // 2) Create a user
      const newUserId = await db.Users.create({
        Name: "JohnDoe",
        Email: "john@doe.com"
      });
      console.log("Created user, ID:", newUserId);

      // 3) Read user by a key (the newly assigned auto-increment ID)
      const userByKey = await db.Users.read(newUserId);
      console.log("User by key:", userByKey);

      // 4) Read user by a field match
      const userByName = await db.Users.read({ Name: "JohnDoe" });
      console.log("User(s) by Name query:", userByName); // array or single record

      // 5) Update user
      userByKey.Email = "john@newdomain.com";
      const updatedKey = await db.Users.update(userByKey);
      console.log("User updated. Key returned:", updatedKey);

      // 6) Delete user
      //await db.Users.delete(updatedKey);
      //console.log("User deleted.");

      // 7) Close DB + terminate worker
      await db.close();
      console.log("DB closed, worker terminated.");
    })();
  </script>
</body>
</html>