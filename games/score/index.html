<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimal-ui">
   <title>Mobile Score Keeper - 3 Player with Rounds</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none; /* Prevents pull-to-refresh on mobile */
        }
        input[type="text"]:focus {
            box-shadow: none;
        }
        .score-container {
            display: flex;
            flex-direction: column; /* Stack current and total score vertically */
            align-items: center;
            margin-bottom: 0.5rem; /* sm:mb-4 */
        }
        .current-score {
            font-size: 3rem; /* text-5xl */
            line-height: 1;
        }
        .total-score-label {
            font-size: 0.875rem; /* text-sm */
            font-weight: normal; /* font-normal */
            color: rgba(255, 255, 255, 0.7); /* Lighter text for label */
            margin-top: 0.25rem; /* mt-1 */
        }
        .total-score-value {
            font-size: 1.5rem; /* text-2xl */
            font-weight: bold; /* font-bold */
        }

        /* Responsive adjustments for score font sizes */
        @media (min-width: 640px) { /* sm breakpoint */
            .current-score {
                font-size: 3.75rem; /* text-6xl */
            }
            .total-score-label {
                font-size: 1rem; /* text-base */
            }
            .total-score-value {
                font-size: 1.875rem; /* text-3xl */
            }
        }
         @media (min-width: 768px) { /* md breakpoint */
            .current-score {
                font-size: 4.5rem; /* text-7xl */
            }
        }

        /* Dealer Puck Styles */
        .dealer-puck {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
            border: 4px solid #b8860b;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 900;
            color: #8b4513;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            box-shadow:
                0 4px 8px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.3),
                inset 0 -2px 4px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            opacity: 0;
            transform: scale(0.8);
        }

        .dealer-puck.active {
            opacity: 1;
            transform: scale(1);
        }

        .dealer-puck:hover {
            transform: scale(1.05);
            box-shadow:
                0 6px 12px rgba(0,0,0,0.4),
                inset 0 2px 4px rgba(255,255,255,0.4),
                inset 0 -2px 4px rgba(0,0,0,0.3);
        }

        .dealer-puck:active {
            transform: scale(0.95);
        }

        .dealer-text {
            font-size: 8px;
            letter-spacing: 0.5px;
        }

        .dealer-icon {
            font-size: 16px;
            margin-bottom: 2px;
        }

        /* Player section positioning for dealer puck */
        .player-section {
            position: relative;
        }

        @media (min-width: 640px) {
            .dealer-puck {
                width: 100px;
                height: 100px;
                font-size: 12px;
                top: 15px;
                right: 15px;
            }
            
            .dealer-text {
                font-size: 10px;
            }
            
            .dealer-icon {
                font-size: 20px;
            }
        }

    </style>
</head>
<body class="bg-gray-900 text-white flex flex-col h-screen overflow-hidden antialiased">

    <div id="player1Section" class="player-section flex-1 flex flex-col items-center justify-center p-2 sm:p-3 bg-sky-700 m-1 rounded-lg sm:rounded-xl shadow-2xl">
        <div id="dealerPuck1" class="dealer-puck" onclick="moveDealerPuck(1)">
            <div class="dealer-icon">♠</div>
            <div class="dealer-text">DEALER</div>
        </div>
        <input type="text" id="player1Name" value="Team 1" maxlength="15" class="text-xl sm:text-2xl font-bold bg-transparent text-center w-full mb-1 sm:mb-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-300 placeholder-sky-200 px-2 py-1">
        <div class="score-container">
            <div id="player1Score" class="current-score font-black text-sky-100 select-none">0</div>
            <div class="total-score-label">Total:</div>
            <div id="player1RunningTotal" class="total-score-value text-sky-200 select-none">0</div>
        </div>
        <div class="flex space-x-2 sm:space-x-3">
            <button id="player1Decrement" aria-label="Decrement Player 1 Score" class="bg-red-600 hover:bg-red-700 active:bg-red-800 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-md sm:rounded-lg text-lg sm:text-xl transition duration-150 ease-in-out w-14 sm:w-20 shadow-lg select-none">-</button>
            <button id="player1Increment" aria-label="Increment Player 1 Score" class="bg-green-600 hover:bg-green-700 active:bg-green-800 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-md sm:rounded-lg text-lg sm:text-xl transition duration-150 ease-in-out w-14 sm:w-20 shadow-lg select-none">+</button>
        </div>
    </div>

    <div id="player2Section" class="player-section flex-1 flex flex-col items-center justify-center p-2 sm:p-3 bg-rose-700 m-1 rounded-lg sm:rounded-xl shadow-2xl">
        <div id="dealerPuck2" class="dealer-puck" onclick="moveDealerPuck(2)">
            <div class="dealer-icon">♠</div>
            <div class="dealer-text">DEALER</div>
        </div>
        <input type="text" id="player2Name" value="Team 2" maxlength="15" class="text-xl sm:text-2xl font-bold bg-transparent text-center w-full mb-1 sm:mb-2 rounded-md focus:outline-none focus:ring-2 focus:ring-rose-300 placeholder-rose-200 px-2 py-1">
        <div class="score-container">
            <div id="player2Score" class="current-score font-black text-rose-100 select-none">0</div>
            <div class="total-score-label">Total:</div>
            <div id="player2RunningTotal" class="total-score-value text-rose-200 select-none">0</div>
        </div>
        <div class="flex space-x-2 sm:space-x-3">
            <button id="player2Decrement" aria-label="Decrement Player 2 Score" class="bg-red-600 hover:bg-red-700 active:bg-red-800 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-md sm:rounded-lg text-lg sm:text-xl transition duration-150 ease-in-out w-14 sm:w-20 shadow-lg select-none">-</button>
            <button id="player2Increment" aria-label="Increment Player 2 Score" class="bg-green-600 hover:bg-green-700 active:bg-green-800 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-md sm:rounded-lg text-lg sm:text-xl transition duration-150 ease-in-out w-14 sm:w-20 shadow-lg select-none">+</button>
        </div>
    </div>

    <div id="player3Section" class="player-section flex-1 flex flex-col items-center justify-center p-2 sm:p-3 bg-emerald-700 m-1 rounded-lg sm:rounded-xl shadow-2xl">
        <div id="dealerPuck3" class="dealer-puck" onclick="moveDealerPuck(3)">
            <div class="dealer-icon">♠</div>
            <div class="dealer-text">DEALER</div>
        </div>
        <input type="text" id="player3Name" value="Team 3" maxlength="15" class="text-xl sm:text-2xl font-bold bg-transparent text-center w-full mb-1 sm:mb-2 rounded-md focus:outline-none focus:ring-2 focus:ring-emerald-300 placeholder-emerald-200 px-2 py-1">
        <div class="score-container">
            <div id="player3Score" class="current-score font-black text-emerald-100 select-none">0</div>
            <div class="total-score-label">Total:</div>
            <div id="player3RunningTotal" class="total-score-value text-emerald-200 select-none">0</div>
        </div>
        <div class="flex space-x-2 sm:space-x-3">
            <button id="player3Decrement" aria-label="Decrement Player 3 Score" class="bg-red-600 hover:bg-red-700 active:bg-red-800 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-md sm:rounded-lg text-lg sm:text-xl transition duration-150 ease-in-out w-14 sm:w-20 shadow-lg select-none">-</button>
            <button id="player3Increment" aria-label="Increment Player 3 Score" class="bg-green-600 hover:bg-green-700 active:bg-green-800 text-white font-bold py-2 px-4 sm:py-3 sm:px-6 rounded-md sm:rounded-lg text-lg sm:text-xl transition duration-150 ease-in-out w-14 sm:w-20 shadow-lg select-none">+</button>
        </div>
    </div>

    <div class="py-2 px-2 sm:py-3 sm:px-4 flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-3 bg-gray-800">
        <button id="nextRoundBtn" class="w-full sm:w-auto bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-gray-900 font-bold py-2 px-6 sm:py-3 rounded-lg text-md sm:text-lg transition duration-150 ease-in-out shadow-lg select-none">Next Round</button>
        <button id="resetScoresBtn" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-bold py-2 px-6 sm:py-3 rounded-lg text-md sm:text-lg transition duration-150 ease-in-out shadow-lg select-none">Reset All</button>
    </div>

    <script>
        // --- DOM Element Selection ---
        const player1NameInput = document.getElementById('player1Name');
        const player1ScoreDisplay = document.getElementById('player1Score');
        const player1RunningTotalDisplay = document.getElementById('player1RunningTotal');
        const player1IncrementBtn = document.getElementById('player1Increment');
        const player1DecrementBtn = document.getElementById('player1Decrement');

        const player2NameInput = document.getElementById('player2Name');
        const player2ScoreDisplay = document.getElementById('player2Score');
        const player2RunningTotalDisplay = document.getElementById('player2RunningTotal');
        const player2IncrementBtn = document.getElementById('player2Increment');
        const player2DecrementBtn = document.getElementById('player2Decrement');

        const player3NameInput = document.getElementById('player3Name');
        const player3ScoreDisplay = document.getElementById('player3Score');
        const player3RunningTotalDisplay = document.getElementById('player3RunningTotal');
        const player3IncrementBtn = document.getElementById('player3Increment');
        const player3DecrementBtn = document.getElementById('player3Decrement');

        const resetScoresBtn = document.getElementById('resetScoresBtn'); // Corrected ID
        const nextRoundBtn = document.getElementById('nextRoundBtn');

        // Dealer puck elements
        const dealerPuck1 = document.getElementById('dealerPuck1');
        const dealerPuck2 = document.getElementById('dealerPuck2');
        const dealerPuck3 = document.getElementById('dealerPuck3');

        // --- Game State ---
        let currentDealer = 1; // Track which player is currently the dealer
        let player1Score = 0;
        let player2Score = 0;
        let player3Score = 0;

        let player1RunningTotal = 0;
        let player2RunningTotal = 0;
        let player3RunningTotal = 0;

        // --- Core Functions ---

        /**
         * Updates the score display for all players on the UI.
         */
        function updateDisplay() {
            player1ScoreDisplay.textContent = player1Score;
            player1RunningTotalDisplay.textContent = player1RunningTotal;

            player2ScoreDisplay.textContent = player2Score;
            player2RunningTotalDisplay.textContent = player2RunningTotal;

            player3ScoreDisplay.textContent = player3Score;
            player3RunningTotalDisplay.textContent = player3RunningTotal;
        }

        /**
         * Resets current round scores to 0.
         */
        function resetCurrentScores() {
            player1Score = 0;
            player2Score = 0;
            player3Score = 0;
        }

        /**
         * Processes the end of a round: adds current scores to running totals
         * and resets current scores.
         */
        function processNextRound() {
           player1RunningTotal += player1Score;
           player2RunningTotal += player2Score;
           player3RunningTotal += player3Score;
           resetCurrentScores();
           rotateDealerPuck();
           updateDisplay();
       }

        /**
         * Resets all scores (current and running) to 0 and player names to default values.
         * Then updates the display.
         */
        function resetGame() {
            resetCurrentScores();
            player1RunningTotal = 0;
            player2RunningTotal = 0;
            player3RunningTotal = 0;
            player1NameInput.value = "Team 1";
            player2NameInput.value = "Team 2";
            player3NameInput.value = "Team 3";
            currentDealer = 1;
            updateDealerPuckDisplay();
            updateDisplay();
        }

        /**
         * Updates the dealer puck display to show only the current dealer's puck
         */
        function updateDealerPuckDisplay() {
            // Hide all dealer pucks
            dealerPuck1.classList.remove('active');
            dealerPuck2.classList.remove('active');
            dealerPuck3.classList.remove('active');
            
            // Show the current dealer's puck
            switch(currentDealer) {
                case 1:
                    dealerPuck1.classList.add('active');
                    break;
                case 2:
                    dealerPuck2.classList.add('active');
                    break;
                case 3:
                    dealerPuck3.classList.add('active');
                    break;
            }
        }

        /**
         * Rotates the dealer puck to the next player
         */
        function rotateDealerPuck() {
            currentDealer = currentDealer === 3 ? 1 : currentDealer + 1;
            updateDealerPuckDisplay();
        }

        /**
         * Manually moves the dealer puck to a specific player
         * @param {number} playerNumber - The player number (1, 2, or 3)
         */
        function moveDealerPuck(playerNumber) {
            if (playerNumber >= 1 && playerNumber <= 3) {
                currentDealer = playerNumber;
                updateDealerPuckDisplay();
            }
        }

        /**
         * Sets up "hold-to-change" functionality for a score button.
         * @param {HTMLElement} button - The button element.
         * @param {Function} actionFunction - The function to call to change the score.
         * @param {Function} [scoreCheckFunction=null] - Optional function to check if action is valid.
         */
        function setupHoldToChange(button, actionFunction, scoreCheckFunction = null) {
            let intervalId = null;
            let timeoutId = null;
            const initialDelay = 400; 
            const repeatDelay = 75;  

            const performAction = () => {
                if (scoreCheckFunction && !scoreCheckFunction()) {
                    stopRapidChange(); 
                    return false; 
                }
                actionFunction();
                updateDisplay();
                return true; 
            };

            const startRapidChange = () => {
                if (intervalId) clearInterval(intervalId); 
                intervalId = setInterval(() => {
                    if (!performAction()) { 
                        stopRapidChange(); 
                    }
                }, repeatDelay);
            };

            const stopRapidChange = () => {
                clearTimeout(timeoutId);
                clearInterval(intervalId);
                timeoutId = null;
                intervalId = null;
            };

            const handlePress = (event) => {
                if (event.type === 'touchstart') {
                    event.preventDefault();
                }
                if (event.type === 'mousedown' && event.button !== 0) {
                    return;
                }
                performAction(); 
                timeoutId = setTimeout(startRapidChange, initialDelay);
            };

            const handleRelease = () => {
                stopRapidChange();
            };

            button.addEventListener('mousedown', handlePress);
            button.addEventListener('touchstart', handlePress, { passive: false });
            button.addEventListener('mouseup', handleRelease);
            button.addEventListener('mouseleave', handleRelease); 
            button.addEventListener('touchend', handleRelease);
            button.addEventListener('touchcancel', handleRelease);
        }

        // --- Event Listener Setup ---
        setupHoldToChange(player1IncrementBtn, () => { player1Score++; });
        setupHoldToChange(player1DecrementBtn, () => { player1Score--; }, () => player1Score > 0);

        setupHoldToChange(player2IncrementBtn, () => { player2Score++; });
        setupHoldToChange(player2DecrementBtn, () => { player2Score--; }, () => player2Score > 0);

        setupHoldToChange(player3IncrementBtn, () => { player3Score++; });
        setupHoldToChange(player3DecrementBtn, () => { player3Score--; }, () => player3Score > 0);

        nextRoundBtn.addEventListener('click', processNextRound);
        resetScoresBtn.addEventListener('click', resetGame);
        
        // --- Initialization ---
        updateDisplay();
        updateDealerPuckDisplay();

    </script>
</body>
</html>
