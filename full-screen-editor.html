<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Screen Editor</title>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --border-color: #333;
        }
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            background-color: var(--bg-color);
        }
        monaco-js-editor {
            width: 100%;
            flex: 1;
        }
        .editor-container {
            display: flex; 
            flex-direction: column; 
            height: 100vh;
        }
        #ai-status {
            position: fixed;
            top: 10px;
            right: 20px;
            z-index: 1000;
            font-size: 11px;
            color: #aaa;
            display: none;
            align-items: center;
            background: rgba(37, 37, 38, 0.8);
            padding: 4px 8px;
            border-radius: 4px;
            pointer-events: none;
        }
        .spinner {
            display: inline-block;
            width: 10px;
            height: 10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="ai-status"><span class="spinner"></span> AI Analysis...</div>
    
    <div class="editor-container">
        <!--editor-controls></editor-controls-->
        <monaco-js-editor></monaco-js-editor>
        <!--editor-console></editor-console-->
    </div>

    <!-- Load Monaco ESM via CDN -->
    <script type="module">
        import * as monaco from 'https://cdn.jsdelivr.net/npm/monaco-editor@0.55.0/+esm';
        window.monaco = monaco;
        window.dispatchEvent(new CustomEvent('monaco-ready'));
    </script>

    <script type="module">
        import './experiments/editor/wc/monaco-editor.js';
        import './experiments/editor/wc/editor-controls.js';
        import './experiments/editor/wc/editor-console.js';

        const editor = document.querySelector('monaco-js-editor');
        const consoleComp = document.querySelector('editor-console');

        // Wire up controls
        window.addEventListener('run-code', () => editor.executeCode());
        window.addEventListener('save-code', () => editor.saveCurrent());
        window.addEventListener('ai-explain', () => editor.callGemini('explain'));
        window.addEventListener('ai-fix', () => editor.callGemini('fix'));
        window.addEventListener('clear-logs', () => consoleComp.clear());

        // Wire up logging
        window.addEventListener('editor-log', (e) => {
            consoleComp.log(e.detail.msg, e.detail.type);
        });

        // Handle logs and errors from the editor's internal execution if needed
        window.addEventListener('message', (e) => {
            if (e.data.type === 'log') consoleComp.log(e.data.data.join(' '));
            else if (e.data.type === 'error') consoleComp.log(e.data.data, 'error');
        });
    </script>
</body>
</html>
